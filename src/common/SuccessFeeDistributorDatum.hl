module common_SuccessFeeDistributorDatum

import { PARAMETER_POLICY } from "./constants"

const SUCCESS_FEE_DISTRIBUTOR_MARKER_POLICY: MintingPolicyHash = PARAMETER_POLICY
const SUCCESS_FEE_DISTRIBUTOR_MARKER_ASSETCLASS: AssetClass = AssetClass::new(SUCCESS_FEE_DISTRIBUTOR_MARKER_POLICY, (7).show().encode_utf8())
const SUCCESS_FEE_DISTRIBUTOR_MARKER_TOKEN: Value = Value::new(SUCCESS_FEE_DISTRIBUTOR_MARKER_ASSETCLASS, 1)

enum SuccessFeeDistributorDatum {
    Marker
    Asset

    func is_asset(self) -> Bool {
        self.switch{
            Asset => true,
            _ => false
        }
    }

    func get_address(tx: Tx) -> Address {
        tx.ref_inputs.find((input: TxInput) -> {
            input.output.value.get_safe(SUCCESS_FEE_DISTRIBUTOR_MARKER_ASSETCLASS) == 1
        }).output.address
    }
}
